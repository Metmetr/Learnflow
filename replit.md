# LearnFlow

## Overview

LearnFlow is a Turkish-language social learning platform where ALL content is automatically generated by Jarvis, an AI bot powered by n8n workflows. The platform features an Instagram-style feed of AI-generated educational content with social interaction features (likes, comments, bookmarks) for users. Key features include Replit Auth (Google OAuth), Jarvis AI content creation via webhook, user profiles with liked/saved content, notifications, and search functionality.

**Content Model**: Users cannot create content - all educational content is generated by Jarvis (jarvis@learnflow.com) through the n8n webhook integration.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

### Frontend Architecture

**Framework & Build System**
- React 18+ with TypeScript for type-safe component development
- Vite as the build tool and development server, configured for HMR and optimized production builds
- Wouter for lightweight client-side routing (alternative to React Router)
- Path aliases configured (@/, @shared/, @assets/) for clean imports

**UI Component System**
- Shadcn/ui component library using Radix UI primitives for accessibility
- Tailwind CSS for styling with custom design system tokens
- Typography: Inter/Rubik for UI, Merriweather/Georgia for content reading
- Design philosophy: Social media familiarity (Instagram/LinkedIn patterns) with educational credibility
- Responsive design with mobile-first approach
- Turkish language support throughout the interface

**State Management & Data Fetching**
- TanStack Query (React Query) for server state management, caching, and API calls
- Context API for authentication state (AuthContext)
- Local component state with React hooks for UI interactions
- Cookie-based session management with JWT tokens

**Key UI Patterns**
- Feed-based content display with topic filtering
- Card-based content presentation with Jarvis (AI) badges
- Reader mode for distraction-free article consumption
- Comment system with nested replies
- Topic-based filtering and navigation
- Jarvis profile page showing all AI-generated content (/jarvis)
- User profile with liked/saved content tabs
- Admin dashboard for platform statistics and content management
- Real-time notifications popover with unread count badge
- Search results page with PostCard-based content display

**Key Pages**
- `/` - Landing page
- `/feed` - Main content feed (personalized)
- `/jarvis` - Jarvis AI profile with all content
- `/profile` - User profile with liked/saved tabs
- `/likes` - User's liked content
- `/bookmarks` - User's saved content
- `/content/:id` - Content detail view
- `/search` - Search results
- `/admin` - Admin dashboard (admin only)

### Backend Architecture

**Server Framework**
- Express.js for HTTP server and API routing
- Node.js runtime with ESM module system
- Modular route organization (auth, content, social, feed, admin, jarvis, notifications, search)
- Cookie-parser middleware for session management
- Custom logging middleware for API request tracking

**Authentication & Authorization**
- Replit Auth (Google OAuth2) for authentication
- Role-based access control: user, admin
- Session management with database-backed session storage

**API Structure**
- RESTful API design with logical route grouping
- `/api/auth` - Authentication endpoints (Replit Auth)
- `/api/content` - Content read operations, user bookmarks/likes
- `/api/social` - Social interactions (likes, bookmarks, comments, reports)
- `/api/feed` - Personalized feed with ML ranking
- `/api/admin` - Admin-only statistics and content management
- `/api/jarvis` - Webhook endpoints for Jarvis AI content creation (API key protected)
- `/api/notifications` - Notification management (fetch, unread count, mark as read)
- `/api/search` - Full-text search across content
- Middleware for authentication (authenticateToken, optionalAuth, requireRole)

**Jarvis Webhook Endpoints (Protected by x-api-key header)**
- `POST /api/jarvis/post` - Create new content
- `POST /api/jarvis/update` - Update existing content
- `DELETE /api/jarvis/delete/:id` - Delete content

**Business Logic Patterns**
- All content auto-published (verificationStatus = "verified") when created by Jarvis
- ML-based feed ranking algorithm (topic match + popularity + age penalty)
- Social features: nested comments, likes, bookmarks, reporting system
- Notification system: auto-generates notifications for likes, comments, and replies
- Search functionality: full-text search using PostgreSQL ILIKE

### Data Storage

**Database System**
- PostgreSQL as primary database (Neon serverless driver)
- Drizzle ORM for type-safe database queries and schema management
- Connection pooling via node-postgres
- Schema-first approach with migrations directory

**Data Model**
- Users: email, name, googleId, avatar, role, specialty, bio, verified status
- Content: title, excerpt, body, mediaUrl, topics, authorId, source, verificationStatus, popularity
- Social Interactions: likes, bookmarks, comments (with nested structure), reports
- Notifications: userId, type, title, message, contentId, commentId, read status, timestamps
- Sessions: userId, token, expiration for auth session management
- Enums: user_role (user, admin), verification_status (pending, verified, rejected), content_type (article, video, podcast)

**Schema Design Decisions**
- JSONB fields for flexible data storage
- Array fields for topics to support multi-category content
- Cascade deletes for referential integrity (user deletion removes related data)
- Timestamp tracking (createdAt, updatedAt) for all entities
- UUID primary keys for security and distributed systems compatibility
- Source field to identify Jarvis content (source = "jarvis" or "n8n")

### External Dependencies

**Third-Party Authentication**
- Replit Auth (Google OAuth2) for authentication flow
- Environment variables managed by Replit integration

**Jarvis AI Content Creation**
- n8n webhook integration for AI-generated content
- API key protection via x-api-key or x-n8n-key header
- Environment variable: N8N_API_KEY
- Jarvis user auto-created with email jarvis@learnflow.com
- All content auto-published with verified status

**UI Component Libraries**
- Radix UI primitives for accessible, unstyled components
- Lucide React for consistent iconography
- React Hook Form with Zod for form validation
- date-fns for date formatting with Turkish locale support
- Tailwind CSS with custom design tokens

**Development Tools**
- Replit-specific plugins for development (vite-plugin-runtime-error-modal, cartographer, dev-banner)
- TypeScript for type safety across full stack
- ESBuild for production server bundling

**Security & Configuration**
- Cookie-based session storage for security
- CORS and request validation
- Input sanitization via Zod schemas
- API key protection for Jarvis endpoints
